build astra:
  tags: [alse]
  stage: build

  before_script:
    - whoami

  script:
    - mkdir -p tmp && cd tmp
#    - cd /local_libs
    - git clone --recurse-submodules http://gitlab-ci-token:${CI_JOB_TOKEN}@uav.radar-mms.com/gitlab/test/essentials/fmtlib.git
    - cd fmtlib
    - cmake -DCMAKE_INSTALL_PREFIX=/local_libs . && make all install
    - find /local_libs
    - cd ../../ && rm -rf tmp

    - mkdir -p target
    - cd target
    - cmake-alse -GNinja -DCMAKE_BUILD_TYPE=Release ..
    - ninja

  artifacts:
    paths: [ target/*.a ]
    expire_in: 1 hour
